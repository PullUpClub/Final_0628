(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[700],{1264:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(2895).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},3447:(e,s,t)=>{"use strict";t.d(s,{default:()=>p});var r=t(5155),l=t(2115),a=t(5695),o=t(8589),i=t(5731),n=t(5324),c=t(1264),d=t(2895);let u=(0,d.A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),m=(0,d.A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var x=t(6766),f=t(3168),h=t(8260),g=t(1218);let w=e=>{let{onSuccess:s}=e,[t,o]=(0,l.useState)(""),[i,c]=(0,l.useState)(""),[d,u]=(0,l.useState)(!1),[m,x]=(0,l.useState)(""),w=(0,a.useRouter)(),{t:p}=(0,g.Bd)(["auth","common"]),b=t.length>=6,y=/[A-Z]/.test(t),v=/[a-z]/.test(t),j=/[0-9]/.test(t),N=t===i,k=b&&y&&v&&j&&N,C=async e=>{if(e.preventDefault(),!k)return void x(p("errors.invalidPassword"));u(!0),x("");try{var r,l,a;console.log("Starting password update...");let{data:{session:e},error:o}=await f.ND.auth.getSession();if(console.log("Current session:",{hasSession:!!e,sessionError:o?{message:o.message,status:o.status,details:o}:null}),!e)throw Error("No valid session found. Please try the reset link again.");console.log("User details:",{id:null==(r=e.user)?void 0:r.id,email:null==(l=e.user)?void 0:l.email,lastSignIn:null==(a=e.user)?void 0:a.last_sign_in_at});let{error:i}=await f.ND.auth.updateUser({password:t});if(i)throw console.error("Password update error details:",{message:i.message,status:i.status,details:i}),i;console.log("Password updated successfully"),h.Ay.success(p("passwordChange.success"),{duration:4e3,style:{background:"#1f2937",color:"#ffffff",border:"1px solid #9b9b6f"},iconTheme:{primary:"#9b9b6f",secondary:"#ffffff"}}),await f.ND.auth.signOut(),console.log("User signed out successfully"),s?s():setTimeout(()=>w.push("/login"),1500)}catch(s){console.error("Password change error:",s);let e=s instanceof Error?s.message:"An error occurred";x(p("errors.updateFailed",{message:e})),h.Ay.error(e,{duration:6e3,style:{background:"#1f2937",color:"#ffffff",border:"1px solid #ef4444"}})}finally{u(!1)}},P=e=>{let{met:s,text:t}=e;return(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,r.jsx)(n.A,{size:16,className:s?"text-green-500":"text-gray-500"}),(0,r.jsx)("span",{className:s?"text-green-500":"text-gray-500",children:t})]})};return(0,r.jsxs)("form",{onSubmit:C,className:"w-full flex flex-col gap-4",children:[(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)("input",{type:"password",value:t,onChange:e=>o(e.target.value),placeholder:p("passwordChange.newPassword"),className:"w-full px-5 py-3 rounded-xl bg-white/10 text-white placeholder-gray-300 text-sm focus:outline-none focus:ring-2 focus:ring-[#9b9b6f]",required:!0})}),(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)("input",{type:"password",value:i,onChange:e=>c(e.target.value),placeholder:p("passwordChange.confirmPassword"),className:"w-full px-5 py-3 rounded-xl bg-white/10 text-white placeholder-gray-300 text-sm focus:outline-none focus:ring-2 focus:ring-[#9b9b6f]",required:!0})}),(0,r.jsxs)("div",{className:"space-y-2 bg-white/5 p-4 rounded-xl",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-300 mb-2",children:[p("passwordChange.requirements"),":"]}),(0,r.jsx)(P,{met:b,text:p("passwordChange.minLength")}),(0,r.jsx)(P,{met:y,text:p("passwordChange.upperCase")}),(0,r.jsx)(P,{met:v,text:p("passwordChange.lowerCase")}),(0,r.jsx)(P,{met:j,text:p("passwordChange.number")}),(0,r.jsx)(P,{met:N,text:p("passwordChange.match")})]}),m&&(0,r.jsx)("div",{className:"text-sm text-red-400 text-left",children:m}),(0,r.jsx)("button",{type:"submit",disabled:d||!k,className:"w-full bg-[#9b9b6f] text-black font-medium px-5 py-3 rounded-full hover:bg-[#7a7a58] transition disabled:opacity-50 disabled:cursor-not-allowed",children:d?p("common:status.loading"):p("passwordChange.submit")})]})},p=()=>{console.log("ResetPasswordPage loaded");let[e,s]=(0,l.useState)(""),[t,d]=(0,l.useState)(!1),[g,p]=(0,l.useState)(""),[b,y]=(0,l.useState)(!1),[v,j]=(0,l.useState)(!1),[N,k]=(0,l.useState)(!1),[C,P]=(0,l.useState)(!1),{}=(0,i.As)(),S=(0,a.useRouter)(),A=(0,l.useCallback)(async()=>{let e=new URLSearchParams(window.location.search),t=e.get("access_token"),r=e.get("type");if(console.log("Token detection:",{hasAccessToken:!!t,type:r}),!t||"recovery"!==r)return void console.log("❌ No reset tokens found");console.log("\uD83D\uDD10 Processing password reset token...");try{var l;let{data:{session:e}}=await f.ND.auth.getSession();if(null==e?void 0:e.user){console.log("✅ Existing session found, using it for password reset"),k(!0),j(!0),s(e.user.email||""),window.history.replaceState({},"","/reset-password");return}console.log("No existing session, verifying reset token...");let{data:r,error:a}=await f.ND.auth.verifyOtp({token_hash:t,type:"recovery"});if(a){console.error("Token verification failed:",a.message),a.message.includes("expired")||a.message.includes("invalid")||a.message.includes("not found")?p("This reset link has expired or been used. Please request a new one."):p("Unable to verify reset link. Please try again or request a new one.");return}(null==(l=r.session)?void 0:l.user)?(console.log("✅ Password reset token verified successfully"),k(!0),j(!0),s(r.session.user.email||""),window.history.replaceState({},"","/reset-password")):(console.error("No session created from token verification"),p("Unable to establish reset session. Please request a new reset link."))}catch(e){console.error("Token processing error:",e),p("Failed to process reset link. Please request a new one.")}},[]);(0,l.useEffect)(()=>{A()},[A]);let U=async s=>{if(s.preventDefault(),!e)return void p("Please enter your email address");d(!0),p("");try{let s=("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||window.location.hostname.includes("localhost"),"".concat(window.location.origin,"/reset-password"));console.log("\uD83D\uDD17 Sending reset email with redirect URL:",s);let{error:t}=await f.ND.auth.resetPasswordForEmail(e,{redirectTo:s});if(t)throw t;P(!0),h.Ay.success("Password reset instructions sent to your email",{duration:4e3,style:{background:"#1f2937",color:"#ffffff",border:"1px solid #9b9b6f"},iconTheme:{primary:"#9b9b6f",secondary:"#ffffff"}})}catch(s){let e=s instanceof Error?s.message:"An error occurred";p("Failed to send reset email: ".concat(e)),h.Ay.error("Failed to send reset email")}finally{d(!1)}};return b?(0,r.jsx)(o.default,{children:(0,r.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-black relative overflow-hidden w-full",children:(0,r.jsxs)("div",{className:"relative z-10 w-full max-w-sm rounded-3xl bg-gradient-to-r from-[#ffffff10] to-[#121212] backdrop-blur-sm shadow-2xl p-8 flex flex-col items-center",children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)(x.default,{src:"/PUClogo-optimized.webp",alt:"Pull-Up Club Logo",width:64,height:64,className:"h-16 w-auto",priority:!0})}),(0,r.jsx)(n.A,{size:48,className:"mx-auto text-green-500 mb-4"}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Password Updated"}),(0,r.jsx)("p",{className:"text-gray-300 text-center mb-4",children:e?"Signing you in automatically...":"Please sign in with your new password."}),(0,r.jsx)("button",{onClick:()=>S.push("/login"),className:"w-full bg-[#9b9b6f] text-black font-medium px-5 py-3 rounded-full hover:bg-[#7a7a58] transition",children:e?"Continue to Profile":"Sign In"})]})})}):C&&!N?(0,r.jsx)(o.default,{children:(0,r.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-black relative overflow-hidden w-full",children:(0,r.jsxs)("div",{className:"relative z-10 w-full max-w-sm rounded-3xl bg-gradient-to-r from-[#ffffff10] to-[#121212] backdrop-blur-sm shadow-2xl p-8 flex flex-col items-center",children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)(x.default,{src:"/PUClogo-optimized.webp",alt:"Pull-Up Club Logo",width:64,height:64,className:"h-16 w-auto",priority:!0})}),(0,r.jsx)(c.A,{size:48,className:"mx-auto text-[#9b9b6f] mb-4"}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Check Your Email"}),(0,r.jsxs)("p",{className:"text-gray-300 text-center mb-4",children:["We've sent password reset instructions to ",(0,r.jsx)("strong",{children:e})]}),(0,r.jsx)("p",{className:"text-gray-400 text-sm text-center mb-6",children:"Click the link in the email to reset your password. The link will expire in 1 hour."}),(0,r.jsxs)("div",{className:"w-full space-y-3",children:[(0,r.jsxs)("button",{onClick:()=>{P(!1),s(""),p("")},className:"w-full bg-white/10 text-white font-medium px-5 py-3 rounded-full hover:bg-white/20 transition flex items-center justify-center",children:[(0,r.jsx)(u,{size:16,className:"mr-2"}),"Try Different Email"]}),(0,r.jsx)("button",{onClick:()=>S.push("/login"),className:"w-full text-gray-400 hover:text-white text-sm underline",children:"Back to Sign In"})]})]})})}):(0,r.jsx)(o.default,{children:(0,r.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-black relative overflow-hidden w-full",children:(0,r.jsxs)("div",{className:"relative z-10 w-full max-w-sm rounded-3xl bg-gradient-to-r from-[#ffffff10] to-[#121212] backdrop-blur-sm shadow-2xl p-8 flex flex-col items-center",children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)(x.default,{src:"/PUClogo-optimized.webp",alt:"Pull-Up Club Logo",width:64,height:64,className:"h-16 w-auto",priority:!0})}),(0,r.jsx)("h2",{className:"text-2xl font-semibold text-[#9b9b6f] mb-6 text-center tracking-wider",children:"PULL-UP CLUB"}),(0,r.jsx)("div",{className:"text-center mb-6",children:N?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m,{size:28,className:"mx-auto text-[#9b9b6f] mb-2"}),(0,r.jsx)("h3",{className:"text-xl text-white",children:"Set New Password"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.A,{size:28,className:"mx-auto text-[#9b9b6f] mb-2"}),(0,r.jsx)("h3",{className:"text-xl text-white",children:"Reset Your Password"}),(0,r.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:"Enter your email and we'll send you reset instructions"})]})}),N?v?(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)(w,{onSuccess:()=>{y(!0),setTimeout(()=>S.push("/login"),1500)}}),(0,r.jsx)("button",{type:"button",onClick:()=>S.push("/login"),className:"text-xs text-gray-400 hover:text-white underline mt-4 text-center w-full",children:"Back to Sign In"})]}):(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-[#9b9b6f] mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-sm text-white",children:g||"Verifying your reset link..."})]}):(0,r.jsxs)("form",{onSubmit:U,className:"flex flex-col w-full gap-4",children:[(0,r.jsx)("input",{type:"email",placeholder:"Enter your email",value:e,onChange:e=>s(e.target.value),className:"w-full px-5 py-3 rounded-xl bg-white/10 text-white placeholder-gray-300 text-sm focus:outline-none focus:ring-2 focus:ring-[#9b9b6f]",required:!0}),g&&(0,r.jsx)("div",{className:"text-sm text-red-400",children:g}),(0,r.jsx)("button",{type:"submit",disabled:t||!e,className:"w-full bg-[#9b9b6f] text-black font-medium px-5 py-3 rounded-full hover:bg-[#7a7a58] transition disabled:opacity-50",children:t?"Sending...":"Send Reset Instructions"}),(0,r.jsx)("button",{type:"button",onClick:()=>S.push("/login"),className:"text-xs text-gray-400 hover:text-white underline",children:"Back to Sign In"})]})]})})})}},5324:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(2895).A)("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},9279:(e,s,t)=>{Promise.resolve().then(t.bind(t,3447))}},e=>{e.O(0,[825,218,661,650,260,116,589,441,964,358],()=>e(e.s=9279)),_N_E=e.O()}]);