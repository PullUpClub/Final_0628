(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{1266:(e,t,n)=>{"use strict";n.d(t,{default:()=>d});var r=n(5155),o=n(2115),a=n(5695),s=n(3554),i=n(3168);function l(){let{user:e,isLoading:t}=function(){let[e,t]=(0,o.useState)(!0),[n,r]=(0,o.useState)(null),[s,l]=(0,o.useState)(null),c=(0,a.useRouter)();return(0,o.useEffect)(()=>{(async()=>{try{let{data:{user:e}}=await i.ND.auth.getUser();if(r(e),e){let{data:t}=await i.ND.from("profiles").select("*").eq("id",e.id).single();l(t)}}catch(e){console.error("Error getting user:",e)}finally{t(!1)}})();let{data:{subscription:e}}=i.ND.auth.onAuthStateChange(async(e,n)=>{if(null==n?void 0:n.user){r(n.user);let{data:e}=await i.ND.from("profiles").select("*").eq("id",n.user.id).single();l(e)}else r(null),l(null);t(!1),c.refresh()});return()=>{e.unsubscribe()}},[c]),{user:n,profile:s,isLoading:e}}();return(0,o.useEffect)(()=>{let n=!1,r=async()=>{if(window.chatbase&&!n)if(e&&!t)try{let e=await fetch("/api/chatbase/verify-user",{method:"POST",headers:{"Content-Type":"application/json"}});if(e.ok){let{userId:t,hash:r}=await e.json();try{window.chatbase("setUser",{identifier:t,hmac:r}),n=!0,console.log("Chatbase user identity set successfully")}catch(e){console.warn("Chatbase setUser failed, trying alternative method:",e),window.chatbase("identify",{userId:t,signature:r}),n=!0}}else console.warn("Failed to verify user identity for Chatbase")}catch(e){console.error("Error setting up Chatbase identity:",e)}else t||e||console.log("Chatbase: User not authenticated, skipping identity setup")};n=!1,r();let o=setInterval(()=>{window.chatbase&&!n&&r()},500),a=setTimeout(()=>{clearInterval(o)},1e4);return()=>{clearInterval(o),clearTimeout(a)}},[e,t]),null}let c=["/","/leaderboard","/rules","/faq","/ethos"];function d(){let e=(0,a.usePathname)(),t=!!e&&c.includes(e);return((0,o.useEffect)(()=>{t&&console.log("\uD83D\uDD0D Chatbase: Loading on public page:",e)},[e,t]),t)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.default,{id:"chatbase-widget",strategy:"afterInteractive",children:'\n          (function(){if(!window.chatbase||window.chatbase("getState")!=="initialized"){window.chatbase=(...arguments)=>{if(!window.chatbase.q){window.chatbase.q=[]}window.chatbase.q.push(arguments)};window.chatbase=new Proxy(window.chatbase,{get(target,prop){if(prop==="q"){return target.q}return(...args)=>target(prop,...args)}})}const onLoad=function(){const script=document.createElement("script");script.src="https://www.chatbase.co/embed.min.js";script.id="goLMmOPyP_9eunG2YxSmj";script.domain="www.chatbase.co";document.body.appendChild(script)};if(document.readyState==="complete"){onLoad()}else{window.addEventListener("load",onLoad)}})();\n        '}),(0,r.jsx)(l,{})]}):null}},6437:(e,t,n)=>{"use strict";n.d(t,{default:()=>P});var r=n(5155),o=n(2115),a=n(5731);class s{async getCache(e){try{let t=this.cache.get(e);if(t&&t.expiry>Date.now())return t.data;let n=localStorage.getItem(e);if(n){let t=JSON.parse(n);if(t.expiry>Date.now())return this.cache.set(e,t),t.data;localStorage.removeItem(e)}return null}catch(e){return console.error("Cache get error:",e),null}}async setCache(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:36e5;try{let r=Date.now()+n,o={data:t,expiry:r};this.cache.set(e,o),localStorage.setItem(e,JSON.stringify(o))}catch(e){console.error("Cache set error:",e)}}async clearAllCaches(){try{this.cache.clear();let e=[];for(let t=0;t<localStorage.length;t++){let n=localStorage.key(t);n&&(n.startsWith("leaderboard")||n.startsWith("user_profile")||n.startsWith("submissions")||n.startsWith("badges"))&&e.push(n)}e.forEach(e=>localStorage.removeItem(e)),console.log("✅ Traditional caches cleared")}catch(e){console.error("Cache clear error:",e)}}async getCacheInfo(){try{let e=Array.from(this.cache.keys());return{size:JSON.stringify(Array.from(this.cache.values())).length,keys:e}}catch(e){return console.error("Cache info error:",e),{size:0,keys:[]}}}constructor(){this.cache=new Map}}let i=new s,l=(0,o.createContext)(void 0),c=e=>{let{children:t}=e,[n,a]=(0,o.useState)(null),s=async()=>await i.getCacheInfo(),c=async()=>(await s()).size,d=async()=>{a(await s())},u=async()=>{await i.clearAllCaches(),await d()};return(0,o.useEffect)(()=>{d()},[]),(0,r.jsxs)(l.Provider,{value:{clearAllCaches:u,getCacheSize:c,getCacheInfo:s,cacheInfo:n,refreshCacheInfo:d},children:[t,!1]})};var d=n(5855),u=n(8043),f=n(5695);let h=["/subscribe","/subscription","/payment","/checkout","/success"],p=e=>{let{children:t}=e,{user:n}=(0,a.As)();(0,f.usePathname)();let[s,i]=(0,o.useState)(!1);(0,o.useEffect)(()=>{window.location&&i(h.some(e=>window.location.pathname.startsWith(e)))},[]);let l={appearance:{theme:"flat",variables:{colorPrimary:"#9b9b6f",colorBackground:"#1e1e1e",colorText:"#ffffff",colorDanger:"#ff5555",fontFamily:"Inter, sans-serif",spacingUnit:"4px",borderRadius:"8px"}},customerEmail:null==n?void 0:n.email,loader:"auto"};return s?(0,r.jsx)(d.Elements,{stripe:u.tA,options:l,children:t}):(0,r.jsx)(r.Fragment,{children:t})};function g(e){let{children:t}=e,[n,a]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{a(!0)},[]),(0,r.jsx)("div",{className:n?"opacity-100 transition-opacity duration-300":"opacity-0",children:t})}var w=n(2810);function b(e){let{children:t}=e,n=(0,o.useRef)(null);return(0,o.useEffect)(()=>{let e=new w.A;return n.current=e,e.on("scroll",e=>{}),requestAnimationFrame(function t(n){e.raf(n),requestAnimationFrame(t)}),()=>{e.destroy(),n.current=null}},[]),(0,o.useEffect)(()=>{n.current&&(window.lenis=n.current)},[]),(0,r.jsx)(r.Fragment,{children:t})}let m=(0,n(5028).default)(()=>n.e(5812).then(n.bind(n,5812)),{loadableGenerated:{webpack:()=>[5812]},ssr:!1,loading:()=>null}),y=e=>{let{children:t}=e;return(0,r.jsxs)(r.Fragment,{children:[t,(0,r.jsx)(m,{})]})};var v=n(8260),x=n(2922),C=n(6715),j=n(1828),k=n(7189);"localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/),n(1618);let E=new x.E({defaultOptions:{queries:{staleTime:12e4,gcTime:3e5,retry:!1,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1},mutations:{retry:!1}}});function S(e){let{children:t}=e;return(0,o.useEffect)(()=>{var e;return console.log("\uD83D\uDE80 Pull-Up Club: Initializing cache management..."),e={onSuccess:e=>{console.log("✅ Pull-Up Club service worker registered successfully")},onUpdate:e=>{console.log("\uD83D\uDD04 Pull-Up Club service worker updated")}},"serviceWorker"in navigator&&new URL("/",window.location.href).origin===window.location.origin&&window.addEventListener("load",()=>{var t,n;console.log("\uD83D\uDD27 Pull-Up Club: Registering service worker for cache management..."),t="/sw.js",n=e,navigator.serviceWorker.register(t,{updateViaCache:"none",scope:"/"}).then(e=>{console.log("\uD83C\uDF89 Pull-Up Club SW registered:",e.scope),e.addEventListener("updatefound",()=>{let t=e.installing;null!=t&&t.addEventListener("statechange",()=>{"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("\uD83D\uDD04 New version detected, updating..."),t.postMessage({type:"SKIP_WAITING"}),(null==n?void 0:n.onUpdate)&&n.onUpdate(e),function(){let e=document.createElement("div");e.innerHTML='\n    <div style="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: #10b981;\n      color: white;\n      padding: 16px 20px;\n      border-radius: 8px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n      z-index: 10000;\n      font-family: -apple-system, BlinkMacSystemFont, sans-serif;\n      font-size: 14px;\n      max-width: 300px;\n    ">\n      <div style="font-weight: 600; margin-bottom: 8px;">\n        \uD83C\uDF89 New version available!\n      </div>\n      <div style="margin-bottom: 12px; opacity: 0.9;">\n        Pull-Up Club has been updated. Refreshing in 3 seconds...\n      </div>\n      <button onclick="window.location.reload()" style="\n        background: rgba(255,255,255,0.2);\n        border: 1px solid rgba(255,255,255,0.3);\n        color: white;\n        padding: 6px 12px;\n        border-radius: 4px;\n        cursor: pointer;\n        font-size: 12px;\n        margin-right: 8px;\n      ">\n        Refresh Now\n      </button>\n      <button onclick="this.closest(\'div\').remove()" style="\n        background: transparent;\n        border: none;\n        color: rgba(255,255,255,0.7);\n        cursor: pointer;\n        font-size: 12px;\n        text-decoration: underline;\n      ">\n        Dismiss\n      </button>\n    </div>\n  ',document.body.appendChild(e),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},1e4)}(),setTimeout(()=>{console.log("\uD83D\uDD04 Auto-refreshing for new version..."),window.location.reload()},3e3)):(console.log("✅ Content cached for offline use"),(null==n?void 0:n.onSuccess)&&n.onSuccess(e)))})}),setInterval(()=>{"visible"===document.visibilityState&&e.update()},3e4),navigator.serviceWorker.addEventListener("message",e=>{var t;(null==(t=e.data)?void 0:t.type)==="CACHE_CLEANED"&&(console.log("\uD83C\uDF89 Cache cleaned, refreshing for latest version"),setTimeout(()=>window.location.reload(),1e3))})}).catch(e=>{console.error("❌ SW registration failed:",e)})}),()=>{}},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.l$,{position:"top-right",toastOptions:{duration:3e3,style:{background:"#1f2937",color:"#ffffff",border:"1px solid #9b9b6f"},success:{style:{background:"#1f2937",color:"#ffffff",border:"1px solid #9b9b6f"},iconTheme:{primary:"#9b9b6f",secondary:"#ffffff"}},error:{style:{background:"#1f2937",color:"#ffffff",border:"1px solid #ef4444"}}}}),t,(0,r.jsx)(j.j,{}),(0,r.jsx)(k.b,{})]})}function P(e){let{children:t}=e;return(0,r.jsx)(g,{children:(0,r.jsx)(C.Ht,{client:E,children:(0,r.jsx)(a.OJ,{children:(0,r.jsx)(c,{children:(0,r.jsx)(p,{children:(0,r.jsx)(b,{children:(0,r.jsx)(y,{children:(0,r.jsx)(S,{children:t})})})})})})})})}},8384:(e,t,n)=>{Promise.resolve().then(n.bind(n,6437)),Promise.resolve().then(n.bind(n,1266)),Promise.resolve().then(n.t.bind(n,4699,23)),Promise.resolve().then(n.t.bind(n,9324,23))},9324:()=>{}},e=>{e.O(0,[4722,3825,1218,7132,8260,5855,1404,5116,8441,5964,7358],()=>e(e.s=8384)),_N_E=e.O()}]);