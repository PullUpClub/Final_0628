(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{1266:(e,t,n)=>{"use strict";n.d(t,{default:()=>d});var o=n(5155),r=n(2115),i=n(5695),a=n(3554),s=n(3168);function l(){let{user:e,isLoading:t}=function(){let[e,t]=(0,r.useState)(!0),[n,o]=(0,r.useState)(null),[a,l]=(0,r.useState)(null),c=(0,i.useRouter)();return(0,r.useEffect)(()=>{(async()=>{try{let{data:{user:e}}=await s.ND.auth.getUser();if(o(e),e){let{data:t}=await s.ND.from("profiles").select("*").eq("id",e.id).single();l(t)}}catch(e){console.error("Error getting user:",e)}finally{t(!1)}})();let{data:{subscription:e}}=s.ND.auth.onAuthStateChange(async(e,n)=>{if(null==n?void 0:n.user){o(n.user);let{data:e}=await s.ND.from("profiles").select("*").eq("id",n.user.id).single();l(e)}else o(null),l(null);t(!1),c.refresh()});return()=>{e.unsubscribe()}},[c]),{user:n,profile:a,isLoading:e}}();return(0,r.useEffect)(()=>{let n=!1,o=async()=>{if(window.chatbase&&!n)if(e&&!t)try{let e=await fetch("/api/chatbase/verify-user",{method:"POST",headers:{"Content-Type":"application/json"}});if(e.ok){let{userId:t,hash:o}=await e.json();try{window.chatbase("setUser",{identifier:t,hmac:o}),n=!0,console.log("Chatbase user identity set successfully")}catch(e){console.warn("Chatbase setUser failed, trying alternative method:",e),window.chatbase("identify",{userId:t,signature:o}),n=!0}}else console.warn("Failed to verify user identity for Chatbase")}catch(e){console.error("Error setting up Chatbase identity:",e)}else t||e||console.log("Chatbase: User not authenticated, skipping identity setup")};n=!1,o();let r=setInterval(()=>{window.chatbase&&!n&&o()},500),i=setTimeout(()=>{clearInterval(r)},1e4);return()=>{clearInterval(r),clearTimeout(i)}},[e,t]),null}let c=["/","/leaderboard","/rules","/faq","/ethos"];function d(){let e=(0,i.usePathname)(),t=!!e&&c.includes(e);return((0,r.useEffect)(()=>{t&&console.log("\uD83D\uDD0D Chatbase: Loading on public page:",e)},[e,t]),t)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.default,{id:"chatbase-widget",strategy:"afterInteractive",children:'\n          (function(){if(!window.chatbase||window.chatbase("getState")!=="initialized"){window.chatbase=(...arguments)=>{if(!window.chatbase.q){window.chatbase.q=[]}window.chatbase.q.push(arguments)};window.chatbase=new Proxy(window.chatbase,{get(target,prop){if(prop==="q"){return target.q}return(...args)=>target(prop,...args)}})}const onLoad=function(){const script=document.createElement("script");script.src="https://www.chatbase.co/embed.min.js";script.id="goLMmOPyP_9eunG2YxSmj";script.domain="www.chatbase.co";document.body.appendChild(script)};if(document.readyState==="complete"){onLoad()}else{window.addEventListener("load",onLoad)}})();\n        '}),(0,o.jsx)(l,{})]}):null}},6437:(e,t,n)=>{"use strict";n.d(t,{default:()=>k});var o=n(5155),r=n(2115),i=n(5731);class a{async getCache(e){try{let t=this.cache.get(e);if(t&&t.expiry>Date.now())return t.data;let n=localStorage.getItem(e);if(n){let t=JSON.parse(n);if(t.expiry>Date.now())return this.cache.set(e,t),t.data;localStorage.removeItem(e)}return null}catch(e){return console.error("Cache get error:",e),null}}async setCache(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:36e5;try{let o=Date.now()+n,r={data:t,expiry:o};this.cache.set(e,r),localStorage.setItem(e,JSON.stringify(r))}catch(e){console.error("Cache set error:",e)}}async clearAllCaches(){try{this.cache.clear();let e=[];for(let t=0;t<localStorage.length;t++){let n=localStorage.key(t);n&&(n.startsWith("leaderboard")||n.startsWith("user_profile")||n.startsWith("submissions")||n.startsWith("badges"))&&e.push(n)}e.forEach(e=>localStorage.removeItem(e)),console.log("✅ Traditional caches cleared")}catch(e){console.error("Cache clear error:",e)}}async getCacheInfo(){try{let e=Array.from(this.cache.keys());return{size:JSON.stringify(Array.from(this.cache.values())).length,keys:e}}catch(e){return console.error("Cache info error:",e),{size:0,keys:[]}}}constructor(){this.cache=new Map}}let s=new a,l=(0,r.createContext)(void 0),c=e=>{let{children:t}=e,[n,i]=(0,r.useState)(null),a=async()=>await s.getCacheInfo(),c=async()=>(await a()).size,d=async()=>{i(await a())},u=async()=>{await s.clearAllCaches(),await d()};return(0,r.useEffect)(()=>{d()},[]),(0,o.jsxs)(l.Provider,{value:{clearAllCaches:u,getCacheSize:c,getCacheInfo:a,cacheInfo:n,refreshCacheInfo:d},children:[t,!1]})};var d=n(5855),u=n(8043),f=n(5695);let h=["/subscribe","/subscription","/payment","/checkout","/success"],w=e=>{let{children:t}=e,{user:n}=(0,i.As)();(0,f.usePathname)();let[a,s]=(0,r.useState)(!1);(0,r.useEffect)(()=>{window.location&&s(h.some(e=>window.location.pathname.startsWith(e)))},[]);let l={appearance:{theme:"flat",variables:{colorPrimary:"#9b9b6f",colorBackground:"#1e1e1e",colorText:"#ffffff",colorDanger:"#ff5555",fontFamily:"Inter, sans-serif",spacingUnit:"4px",borderRadius:"8px"}},customerEmail:null==n?void 0:n.email,loader:"auto"};return a?(0,o.jsx)(d.Elements,{stripe:u.tA,options:l,children:t}):(0,o.jsx)(o.Fragment,{children:t})};function p(e){let{children:t}=e,[n,i]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{i(!0)},[]),(0,o.jsx)("div",{className:n?"opacity-100 transition-opacity duration-300":"opacity-0",children:t})}var g=n(2810);function b(e){let{children:t}=e,n=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=new g.A;return n.current=e,e.on("scroll",e=>{}),requestAnimationFrame(function t(n){e.raf(n),requestAnimationFrame(t)}),()=>{e.destroy(),n.current=null}},[]),(0,r.useEffect)(()=>{n.current&&(window.lenis=n.current)},[]),(0,o.jsx)(o.Fragment,{children:t})}var m=n(8832);let y=e=>{let{children:t}=e;return(0,r.useEffect)(()=>{window.__META_PIXEL_INITIALIZED__||(console.log("\uD83D\uDD0D Meta Pixel: Initializing from AnalyticsWrapper"),(0,m.CZ)(),window.__META_PIXEL_INITIALIZED__=!0)},[]),(0,o.jsx)(o.Fragment,{children:t})};var v=n(8260),x=n(2922),I=n(6715),_=n(1828),E=n(7189);"localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/),n(1618);let C=new x.E({defaultOptions:{queries:{staleTime:12e4,gcTime:3e5,retry:!1,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1},mutations:{retry:!1}}});function P(e){let{children:t}=e;return(0,r.useEffect)(()=>{var e;return console.log("\uD83D\uDE80 Pull-Up Club: Initializing cache management..."),e={onSuccess:e=>{console.log("✅ Pull-Up Club service worker registered successfully")},onUpdate:e=>{console.log("\uD83D\uDD04 Pull-Up Club service worker updated")}},"serviceWorker"in navigator&&new URL("/",window.location.href).origin===window.location.origin&&window.addEventListener("load",()=>{var t,n;console.log("\uD83D\uDD27 Pull-Up Club: Registering service worker for cache management..."),t="/sw.js",n=e,navigator.serviceWorker.register(t,{updateViaCache:"none",scope:"/"}).then(e=>{console.log("\uD83C\uDF89 Pull-Up Club SW registered:",e.scope),e.addEventListener("updatefound",()=>{let t=e.installing;null!=t&&t.addEventListener("statechange",()=>{"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("\uD83D\uDD04 New version detected, updating..."),t.postMessage({type:"SKIP_WAITING"}),(null==n?void 0:n.onUpdate)&&n.onUpdate(e),function(){let e=document.createElement("div");e.innerHTML='\n    <div style="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: #10b981;\n      color: white;\n      padding: 16px 20px;\n      border-radius: 8px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n      z-index: 10000;\n      font-family: -apple-system, BlinkMacSystemFont, sans-serif;\n      font-size: 14px;\n      max-width: 300px;\n    ">\n      <div style="font-weight: 600; margin-bottom: 8px;">\n        \uD83C\uDF89 New version available!\n      </div>\n      <div style="margin-bottom: 12px; opacity: 0.9;">\n        Pull-Up Club has been updated. Refreshing in 3 seconds...\n      </div>\n      <button onclick="window.location.reload()" style="\n        background: rgba(255,255,255,0.2);\n        border: 1px solid rgba(255,255,255,0.3);\n        color: white;\n        padding: 6px 12px;\n        border-radius: 4px;\n        cursor: pointer;\n        font-size: 12px;\n        margin-right: 8px;\n      ">\n        Refresh Now\n      </button>\n      <button onclick="this.closest(\'div\').remove()" style="\n        background: transparent;\n        border: none;\n        color: rgba(255,255,255,0.7);\n        cursor: pointer;\n        font-size: 12px;\n        text-decoration: underline;\n      ">\n        Dismiss\n      </button>\n    </div>\n  ',document.body.appendChild(e),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},1e4)}(),setTimeout(()=>{console.log("\uD83D\uDD04 Auto-refreshing for new version..."),window.location.reload()},3e3)):(console.log("✅ Content cached for offline use"),(null==n?void 0:n.onSuccess)&&n.onSuccess(e)))})}),setInterval(()=>{"visible"===document.visibilityState&&e.update()},3e4),navigator.serviceWorker.addEventListener("message",e=>{var t;(null==(t=e.data)?void 0:t.type)==="CACHE_CLEANED"&&(console.log("\uD83C\uDF89 Cache cleaned, refreshing for latest version"),setTimeout(()=>window.location.reload(),1e3))})}).catch(e=>{console.error("❌ SW registration failed:",e)})}),()=>{}},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(v.l$,{position:"top-right",toastOptions:{duration:3e3,style:{background:"#1f2937",color:"#ffffff",border:"1px solid #9b9b6f"},success:{style:{background:"#1f2937",color:"#ffffff",border:"1px solid #9b9b6f"},iconTheme:{primary:"#9b9b6f",secondary:"#ffffff"}},error:{style:{background:"#1f2937",color:"#ffffff",border:"1px solid #ef4444"}}}}),t,(0,o.jsx)(_.j,{}),(0,o.jsx)(E.b,{})]})}function k(e){let{children:t}=e;return(0,o.jsx)(p,{children:(0,o.jsx)(I.Ht,{client:C,children:(0,o.jsx)(i.OJ,{children:(0,o.jsx)(c,{children:(0,o.jsx)(w,{children:(0,o.jsx)(b,{children:(0,o.jsx)(y,{children:(0,o.jsx)(P,{children:t})})})})})})})})}},8384:(e,t,n)=>{Promise.resolve().then(n.bind(n,6437)),Promise.resolve().then(n.bind(n,1266)),Promise.resolve().then(n.t.bind(n,4699,23)),Promise.resolve().then(n.t.bind(n,9324,23))},8832:(e,t,n)=>{"use strict";n.d(t,{CZ:()=>i,yM:()=>a});let o="1512318086417813";function r(){try{if(!window.fbq||"function"!=typeof window.fbq||!window.fbq.loaded)return!0;return!1}catch(e){return console.warn("\uD83D\uDD0D Meta Pixel: Error checking if blocked:",e),!0}}function i(){if(window.__META_PIXEL_INITIALIZED__)return void console.log("\uD83D\uDD0D Meta Pixel: Already initialized (global flag)");if(window.fbq&&window.fbq.loaded){console.log("\uD83D\uDD0D Meta Pixel: Already initialized from HTML"),window.__META_PIXEL_INITIALIZED__=!0;return}if(window.fbq){console.log("\uD83D\uDD0D Meta Pixel: Already initialized"),window.__META_PIXEL_INITIALIZED__=!0;return}window.__META_PIXEL_INITIALIZED__=!0;let e=document.createElement("script");e.async=!0,e.src="https://connect.facebook.net/en_US/fbevents.js",e.onerror=()=>{console.error("\uD83D\uDD0D Meta Pixel: Failed to load script"),window.__META_PIXEL_INITIALIZED__=!1},e.onload=()=>{console.log("\uD83D\uDD0D Meta Pixel: Script loaded successfully")},document.head.appendChild(e),window.fbq=function(){window.fbq.callMethod?window.fbq.callMethod.apply(window.fbq,arguments):window.fbq.queue.push(arguments)},window.fbq.push=window.fbq,window.fbq.loaded=!0,window.fbq.version="2.0",window.fbq.queue=[],window.fbq("init",o),window.fbq("track","PageView"),console.log("\uD83D\uDD0D Meta Pixel: Initialized with ID:",o)}async function a(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{(function e(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var o;if(r()){console.warn("\uD83D\uDD0D Meta Pixel: Pixel appears to be blocked by ad blocker or not loaded"),i(),setTimeout(()=>{r()?console.error("\uD83D\uDD0D Meta Pixel: Still blocked after retry - falling back to server-side tracking only"):e(t,n)},2e3);return}if(!window.fbq){console.warn("\uD83D\uDD0D Meta Pixel: Not initialized, attempting to initialize..."),i(),setTimeout(()=>{window.fbq?e(t,n):console.error("\uD83D\uDD0D Meta Pixel: Failed to initialize after retry")},1e3);return}let a=["PageView","ViewContent","Search","AddToCart","AddToWishlist","InitiateCheckout","AddPaymentInfo","Purchase","Lead","CompleteRegistration","Subscribe","StartTrial"].includes(t)?"track":"trackCustom";window.fbq&&!window.fbq.debug&&window.fbq("set","debug",!0),window.fbq(a,t,n),console.log("\uD83D\uDD0D Meta Pixel: Tracked event",{method:a,eventName:t,parameters:n,pixelLoaded:!!(null==(o=window.fbq)?void 0:o.loaded),pixelBlocked:r()})}catch(e){console.error("\uD83D\uDD0D Meta Pixel: Error tracking event",{eventName:t,parameters:n,error:e})}})(e,n),await fetch("".concat("https://yqnikgupiaghgjtsaypr.supabase.co","/functions/v1/meta-conversions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlxbmlrZ3VwaWFnaGdqdHNheXByIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc5NDIzMDMsImV4cCI6MjA2MzUxODMwM30.3rR9EyNlWSLZAoYqlCa3MOJobHH7RHjak0m_3mI6YZs")},body:JSON.stringify({event_name:e,user_data:t,custom_data:n})})}catch(t){console.error("\uD83D\uDD0D Meta Pixel: Error tracking conversion",{eventName:e,error:t})}}},9324:()=>{}},e=>{e.O(0,[722,825,218,661,260,855,913,116,441,964,358],()=>e(e.s=8384)),_N_E=e.O()}]);